class TiendaController < ApplicationController

def index
  @discos = Disco.all
end

def create
  id = params[:id]
  album = params[:album]
  artista = params[:artista]
  a単o = params[:year]
  
  hashDisco = {}
  hashDisco[:id] = id
  hashDisco[:album] = album
  hashDisco[:artista] = artista
  hashDisco[:year] = a単o
  
  @disco = Disco.create(hashDisco)
    if @disco.errors.any? then
      puts "BDERROR: Error"
    else
      @discos = Disco.all
      render :index  
    end
end

def searchByYear
    year = params[:year]
    @encontrados = Disco.where(["year LIKE ?", "%#{year}%"])
    render :busquedas
end

def searchByArtist
    artista = params[:artista]
    @encontrados = Disco.where(["artista LIKE ?", "%#{artista}%"])
    render :busquedas
end

def modificar_vista
    @disco = nil
    id = params[:id]
    @disco = Disco.find id
end

def update 
      id = params[:id]
      album = params[:album]
      artista = params[:artista]
      a単o = params[:year]
    
      hashDisco = {}
      hashDisco[:id] = id
      hashDisco[:album] = album
      hashDisco[:artista] = artista
      hashDisco[:year] = a単o
    
    @disco = Disco.find id 
    update = @disco.update_attributes(hashDisco)
    #update contiene un boolean de si ha ido bien o no
    #registro contiene el activeRecord con los posibles errores
    if update
      puts "Registro actualizado" 
      @discos = Disco.all
      render :index
    else 
      puts "Registro no actualizado"
      render :modificar_vista
    end
end

def delete
    id = params[:id]
    Disco.delete id
    @discos = Disco.all 
    render :index
end

end